{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://imagefront.dev/schemas/component-manifest.schema.json",
  "title": "Component Manifest",
  "description": "Schema for component manifests - defines components, props, state, events, and API calls derived from UI annotations",
  "type": "object",
  "required": ["version", "screenId", "framework", "components"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^v\\d+$",
      "description": "Version identifier matching annotation version"
    },
    "screenId": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9]*(-[a-z0-9]+)*$",
      "description": "Screen identifier in kebab-case"
    },
    "framework": {
      "type": "string",
      "enum": ["react", "vue", "angular", "svelte", "solid", "agnostic"],
      "description": "Target frontend framework (or agnostic)"
    },
    "createdAt": {
      "type": "string",
      "format": "date-time"
    },
    "derivedFrom": {
      "type": "string",
      "description": "Annotation file this manifest was derived from",
      "examples": ["ui_specs/login-screen/versions/2026-01-10-v1.json"]
    },
    "components": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "name", "type"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique component ID"
          },
          "name": {
            "type": "string",
            "description": "Component name (PascalCase or camelCase)"
          },
          "type": {
            "type": "string",
            "description": "Component type or category",
            "examples": ["form", "button", "input", "card", "layout", "page"]
          },
          "path": {
            "type": "string",
            "description": "Suggested file path for this component",
            "examples": ["components/forms/LoginForm.tsx", "components/ui/Button.tsx"]
          },
          "description": {
            "type": "string",
            "description": "Purpose and behavior of this component"
          },
          "props": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name", "type"],
              "properties": {
                "name": {
                  "type": "string"
                },
                "type": {
                  "type": "string",
                  "description": "TypeScript/PropTypes type",
                  "examples": ["string", "number", "boolean", "() => void", "User", "string[]"]
                },
                "required": {
                  "type": "boolean",
                  "default": false
                },
                "defaultValue": {
                  "description": "Default value for this prop"
                },
                "description": {
                  "type": "string"
                }
              }
            }
          },
          "state": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name", "type"],
              "properties": {
                "name": {
                  "type": "string"
                },
                "type": {
                  "type": "string"
                },
                "initialValue": {
                  "description": "Initial state value"
                },
                "description": {
                  "type": "string"
                }
              }
            }
          },
          "events": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name", "handler"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Event name (e.g., onSubmit, onClick)"
                },
                "handler": {
                  "type": "string",
                  "description": "Handler function name"
                },
                "description": {
                  "type": "string"
                },
                "parameters": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {"type": "string"},
                      "type": {"type": "string"}
                    }
                  }
                }
              }
            }
          },
          "dependencies": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Component IDs this component depends on"
          },
          "apiCalls": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["endpoint", "method"],
              "properties": {
                "endpoint": {
                  "type": "string",
                  "description": "API endpoint path",
                  "examples": ["/auth/login", "/users", "/posts/{id}"]
                },
                "method": {
                  "type": "string",
                  "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
                },
                "description": {
                  "type": "string"
                },
                "requestSchema": {
                  "type": "object",
                  "description": "Expected request body schema"
                },
                "responseSchema": {
                  "type": "object",
                  "description": "Expected response schema"
                },
                "authentication": {
                  "type": "boolean",
                  "description": "Whether this call requires authentication"
                }
              }
            }
          },
          "styling": {
            "type": "object",
            "properties": {
              "cssModules": {"type": "boolean"},
              "styledComponents": {"type": "boolean"},
              "tailwind": {"type": "boolean"},
              "classes": {
                "type": "array",
                "items": {"type": "string"}
              }
            }
          },
          "annotationRefs": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^UI-[0-9]{3,}$"
            },
            "description": "Annotation IDs this component is derived from"
          }
        }
      }
    },
    "routing": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "description": "Route path for this screen"
        },
        "params": {
          "type": "array",
          "items": {"type": "string"},
          "description": "URL parameters"
        },
        "query": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Query parameters"
        },
        "guards": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Route guards (e.g., authGuard, roleGuard)"
        }
      }
    },
    "dataRequirements": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "entity": {
            "type": "string",
            "description": "Entity/model name",
            "examples": ["User", "Post", "Comment"]
          },
          "fields": {
            "type": "array",
            "items": {"type": "string"}
          },
          "operations": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["create", "read", "update", "delete", "list"]
            }
          }
        }
      }
    }
  }
}
